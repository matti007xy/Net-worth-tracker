{% extends "base.html" %}

{% block content %}
<h2 class="mb-3">Net Worth History</h2>

{% if dates %}
<div class="card">
    <div class="card-body">
        <canvas id="historyChart"></canvas>
    </div>
</div>

<div class="mt-3 text-center">
    <form method="POST" action="/snapshot" class="d-inline">
        <button type="submit" class="btn btn-outline-dark">Take Snapshot Now</button>
    </form>
</div>
{% else %}
<div class="alert alert-secondary">
    No snapshots yet. Take your first snapshot to start tracking history.
    <form method="POST" action="/snapshot" class="mt-2">
        <button type="submit" class="btn btn-dark">Take First Snapshot</button>
    </form>
</div>
{% endif %}
{% endblock %}

{% block scripts %}
{% if dates %}
<script>
const dates = {{ dates | tojson }};
const values = {{ values | tojson }};

new Chart(document.getElementById('historyChart'), {
    type: 'line',
    data: {
        labels: dates,
        datasets: [{
            label: 'Net Worth (SEK)',
            data: values,
            borderColor: '#0d6efd',
            backgroundColor: 'rgba(13, 110, 253, 0.1)',
            fill: true,
            tension: 0.3,
            pointRadius: 4,
            pointHoverRadius: 6
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                ticks: {
                    callback: function(value) {
                        return value.toLocaleString('sv-SE') + ' kr';
                    }
                }
            }
        },
        plugins: {
            tooltip: {
                callbacks: {
                    label: function(ctx) {
                        return ctx.parsed.y.toLocaleString('sv-SE') + ' kr';
                    }
                }
            }
        }
    }
});
</script>
{% endif %}
{% endblock %}
